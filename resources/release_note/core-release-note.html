<html>
   <head>
      <title>ADOP Home</title>
      <style type = "text/css">
         body { font-family: Helvetica, Arial, sans-serif; }
         table { width:50%; border-spacing: 1; margin:2px; }
         td, th { height: 30px; text-align: left; padding: 2px; }
         th { background: rgb(42, 56, 69);font-weight: bold; color:white; }
         li {
             list-style-type: none;
         }
      </style>
      <script src="js/jquery.js"></script>
      <!-- Latest compiled and minified CSS -->
      <link rel="stylesheet" href="css/bootstrap.min.css">
      <!-- Optional theme -->
      <link rel="stylesheet" href="css/bootstrap-theme.min.css">
      <!-- Latest compiled and minified JavaScript -->
      <script src="js/bootstrap.min.js"></script>
      <link rel="stylesheet" type="text/css" href="css/common.css">
      <!-- Overides -->
      <style type = "text/css">
         .container { margin-left: 0; }
         
         .bs-callout { padding: 10px; margin: 10px; }
      </style>

      <script type = "text/javascript">
         window.onload = function(){
         document.getElementById('kibana').href = createUrl("kibana") + "//index.html#/dashboard/file/logstash.json";
         document.getElementById('shipyard').href = createUrl("shipyard");
         document.getElementById('selenium_grid').href = createUrl("selenium") +"//grid/console";
         document.getElementById('sensu').href = createUrl("sensu");
         document.getElementById('consul').href = createUrl("consul");
         document.getElementById('nexus').href = createUrl("nexus");
         }
         
         function createUrl(host){
                 return "http://"+ host + "." + window.location.host+ (window.location.host.indexOf(".xip.io") > -1 ? "" : ".xip.io/")
         }
         
      </script>
   </head>
   <body>
      <h1 class="text-center">Accenture DevOps Platform</h1>
      <br />
      <div class="bs-callout bs-callout-primary">
         <h4>Welcome to your own dedicated Continuous Delivery platform.</h4>
         <br />
         This can be used for demos, training, and starting real projects.<br />
         Please see the <a target="_blank" href="https://alm.accenture.com/wiki/pages/viewpage.action?pageId=148898151">Frequently Demoed Features</a> wiki page for example ADOP use cases.<br>
         Please use <a target='_blank' href="http://www.google.com/chrome/">Google Chrome </a>or <a target='_blank' href="https://www.mozilla.org/en-GB/firefox/new/">Firefox </a>when navigating the wiki pages and performing the demo(s) as Internet Explorer has performance issues.
      </div>
      <h3>Getting Started</h3>
      <blockquote>
         <a target="_blank" href="https://alm.accenture.com/wiki/display/DOT/Accenture+DevOps+Platform">ADOP Overview</a>
         <footer>An overview of your Accenture DevOps Platform (ADOP) environment.</footer>
         <br />
         <a target="_blank" href="https://alm.accenture.com/wiki/display/DOT/Architecture">ADOP Architecture</a>
         <footer>Your ADOP offices architecture overview.</footer>
         <br />
         <a target="_blank" href="https://alm.accenture.com/wiki/pages/viewpage.action?pageId=148898151">Frequently Demoed Features</a>
         <footer>A link to example scenarios you may wish to perform in your environment.</footer>
      </blockquote>
      <form class="form-horizontal">
         <h3>Credentials</h3>
         <div class="form-group">
            <br />
            <label class="col-sm-1 control-label">Username</label>
            <div class="col-sm-10">
               <p class="form-control-static">john.smith</p>
            </div>
         </div>
      </form>
      <h3>Tool Links & Status</h3>
      <script>            
         $(function() {
             startRefresh();
         });

         function getStatusClass(status,node_status){

           if (status === "passing" && node_status === "passing")
               return "bs-callout bs-callout-success"
           else
              return "bs-callout bs-callout-danger"
         }

         function startRefresh() {
             setTimeout(startRefresh,10000);
             $.get(createUrl("consul") + '/v1/internal/ui/nodes', function(data) {
                  results = {}
                   for (var i = 0; i < data.length; i++) {
                     checks = data[i]['Checks']

                     for (var y = 0; y < data.length; y++) {
                        try {
                           serviceName = checks[y]['ServiceName']
                           if (serviceName === "") {
                               serviceName += data[i]['Node'] + '-serf'
                           }

                           results[serviceName] = checks[y]['Status'] 
                           }catch(err){

                           }
                     };
                   };

                   $('#jenkins').removeClass()
                   $('#jenkins').addClass(getStatusClass(results['jenkins'], results['ci-serf'])); 
                   $('#gerrit').removeClass()
                   $('#gerrit').addClass(getStatusClass(results['gerrit'], results['ldap-gerrit-shipyard-selenium-serf']));
                   $('#sonar').removeClass()
                   $('#sonar').addClass(getStatusClass(results['sonar'], results['ci-serf']));
                   $('#artifacts-nexus').removeClass()
                   $('#artifacts-nexus').addClass(getStatusClass(results['nexus'], results['nexus-serf']));
                   $('#sensu-rp').removeClass()
                   $('#sensu-rp').addClass(getStatusClass(results['sensu'], results['sensu-serf']));
                   $('#elk').removeClass()
                   $('#elk').addClass(getStatusClass(results['kibana'], results['elk-serf']))
                   $('#ldap-gerrit-shipyard-selenium').removeClass()
                   $('#ldap-gerrit-shipyard-selenium').addClass(getStatusClass(results['hub'],results['ldap-gerrit-shipyard-selenium-serf'] ));
                   $('#shipyard-container').removeClass()
                   $('#shipyard-container').addClass(getStatusClass(results['shipyard'], results['ldap-gerrit-shipyard-selenium-serf']));
                   $('#consul-rp').removeClass()
                   $('#consul-rp').addClass(getStatusClass(results['nginx'], results['reverse-proxy-serf']));
             });
         }
      </script>
      <div class="container">
        <div class="row">
            <div class="col-xs-6 col-md-3">
                 <div class="bs-callout bs-callout-info" id = 'jenkins'>
                   <h4>
                      <a target = "_blank" href ="/jenkins">Jenkins</a>
                   </h4>
                   <ul>
                      <li>
                         <a target = "_blank" href ="/jenkins/view/Environment%20Dashboard/">Environment Dashboard</a>
                      </li>
                   </ul>
                 </div>
                 <div class="bs-callout bs-callout-info" id='gerrit'>
                   <h4>
                      <a target = "_blank" href ="/gerrit">Gerrit</a>
                   </h4>
                 </div>
                 <div class="bs-callout bs-callout-info" id='sonar'>
                   <h4>
                      <a target = "_blank" href ="/sonar">Sonar</a>
                   </h4>
                 </div>
                 <div class="bs-callout bs-callout-info" id = 'artifacts-nexus'>
                   <h4>
                      <a target = "_blank" id='nexus' href ="/">Nexus</a>
                   </h4>
                 </div>
                 <div class="bs-callout bs-callout-info" id='sensu-rp'>
                   <h4>
                      <a target = "_blank" id="sensu" href ="/">Sensu</a>
                   </h4>
                 </div>
            </div>
            <div class="col-xs-6 col-md-3">
                 <div class="bs-callout bs-callout-info" id='elk'>
                   <h4>
                      <a target = "_blank" id = 'kibana' href ="/">Kibana Dashboard (ELK)</a>
                   </h4>
                 </div>
                 <div class="bs-callout bs-callout-info" id='ldap-gerrit-shipyard-selenium'>
                   <h4>
                      <a target = "_blank" id = 'selenium_grid' href ="/">Selenium Grid View</a>
                   </h4>
                 </div>
                 <div class="bs-callout bs-callout-info" id='shipyard-container'>
                   <h4>
                      <a target = "_blank" id = 'shipyard' href ="/">Shipyard</a>
                   </h4>
                 </div>
                 <div class="bs-callout bs-callout-info" id='consul-rp'>
                   <h4>
                      <a target = "_blank" id='consul' href ="/">Consul</a>
                   </h4>
                 </div>
            </div>
        </div>
      </div>
      <br />
   </body>
</html>

